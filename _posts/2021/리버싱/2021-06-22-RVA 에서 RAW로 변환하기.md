---
title:  "[리버싱] RVA 에서 RAW로 변환하기"
excerpt: "RVA에서 RAW로 변환하는 방법에 대해 알아보자"

categories: 리버싱


tags:
    - RVA
    - RAW
    - Offset

last_modified_at: 2021-06-22T12:19:00+09:00
---


- RVA = 섹션 시작 VA - 섹션 끝 VA = 실제 주소 - Image Header
- VA = 각 섹션의 시작 혹은 끝 주소
- RAW = RVA - VitualAddress + PointerToRawData
- RAW - PointerToRawData = RVA - VitualAddress

    RAW: 파일에서의 주소 / RVA: 메모리에서의 주소

    (특정 지점에서 섹션의 시작 지점을 뺀 값은 동일함)

1. 주소의 종류
    - Offset: 파일에서의 절대 주소
    - VA: 프로세스가 가상메모리에 로딩되었을 때의 절대주소
2. 세션의 시작 주소
    - PointerToRawData: 파일에서 섹션의 시작위치 (Offset 값)
    - VirtualAddress: 메모리에서 섹션의 시작 위치 (VA값)
3. 세션 내 특정 주소
    - RAW: 파일에서 특정한 위치의 주소 (Offset 값)
    - RVA: 메모리에서 특정한 위치의 장소 (VA 값)

        *(참고: VA = RVA + ImageBase)*

![그림1. 파일에서 메모리로 로드할 때의 변화](https://github.com/op2gs2/op2gs2.github.io/blob/main/assets/images/2021/%EB%A6%AC%EB%B2%84%EC%8B%B1/Offset2VA.png?raw=true "그림1. 파일에서 메모리로 로드할 때의 변화")

- STEP 0. RVA가 위치한 섹션 찾기

    : RVA가 3000이므로, 1001000과 1054000 사이에 있는 .text 섹션에 위치함을 알 수 있다.

- STEP 1. VirtualAddress 구하기

    : VirtualAddress = 1001000 (섹션 시작주소; VA값) - 1000000 (ImageBase) = 1000

- STEP 2. PointerToRaw 구하기

    : PointerToRaw = 400 (.text 섹션의 시작 Offset 주소값)

- STEP 3. RAW 값 구하기

    : RAW = 3000 - 1000 + 400 = 2400
